--TOTAL DE CONTRATO POR ESTADO E DATA
SELECT ALU.Estado, Trunc(CON.DATA) AS DATA,
       SUM(CON.Total) TOTAL, Count(*) qtde

FROM   TALUNO ALU, TCONTRATO CON
WHERE  ALU.COD_ALUNO = CON.COD_ALUNO
GROUP  BY  ALU.Estado, Trunc(CON.DATA)
ORDER  BY  ALU.ESTADO, DATA DESC;
