SELECT Trunc(DATA),COD_ALUNO,SUM(TOTAL),
       RANK() OVER (PARTITION BY Trunc(DATA)
   		  ORDER BY SUM(TOTAL) DESC) POSICAO
FROM TCONTRATO
GROUP BY (Trunc(DATA),COD_ALUNO)
ORDER BY COD_ALUNO;